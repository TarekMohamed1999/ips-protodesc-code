    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1|     Type    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            Version                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  DCIL |  SCIL |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Destination Connection ID               ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Source Connection ID                  ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                             Length                          ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Packet Number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            Payload                          ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                   Figure 10: Long Header Packet Format

   Long headers are used for packets that are sent prior to the
   completion of version negotiation and establishment of 1-RTT keys.
   Once both conditions are met, a sender switches to sending packets
   using the short header (Section 17.3).  The long form allows for
   special packets - such as the Version Negotiation packet - to be
   represented in this uniform fixed-length packet format.  Packets that
   use the long header contain the following fields:

   Header Form: 1 bit

      The most significant bit (0x80) of octet 0 (the first octet) is
      set to 1 for long headers.

   Long Packet Type: 7 bits

      The remaining seven bits of octet 0 contain the packet type.  This
      field can indicate one of 128 packet types. The types specified
      for this version are listed in Table 6.

   Version: 32 bits

      The QUIC Version is a 32-bit field that follows the Type. This
      field indicates which version of QUIC is in use and determines how
      the rest of the protocol fields are interpreted.

   DCIL: 4 bits

      The 4 bits following the version contains the length of the
      Destination Connection ID field. These bits are encoded as 4-bit
      unsigned integers.  An encoded length of 0 indicates that the
      connection ID is also 0 octets in length.  Non-zero encoded
      lengths are increased by 3 to get the full length of the
      connection ID, producing a length between 4 and 18 octets
      inclusive.  For example, an octet with the value 0x50 describes an
      8-octet Destination Connection ID and a zero-length Source
      Connection ID.

   SCIL: 4 bits

      The 4 bits following the DCIL contains the length of the
      Source Connection ID field. These bits are encoded as 4-bit
      unsigned integers.  An encoded length of 0 indicates that the
      connection ID is also 0 octets in length.  Non-zero encoded
      lengths are increased by 3 to get the full length of the
      connection ID, producing a length between 4 and 18 octets
      inclusive.  For example, an octet with the value 0x50 describes an
      8-octet Destination Connection ID and a zero-length Source
      Connection ID.

   Destination Connection ID: ((DCIL == 0) ? 0 : (DCIL+3) * 8) bits

      The Destination Connection ID field follows the connection ID
      lengths and is either 0 octets in length or between 4 and 18
      octets.  Section 7.2 describes the use of this field in more
      detail.

   Source Connection ID: ((SCIL == 0) ? 0 : (SCIL+3) * 8) bits

      The Source Connection ID field follows the Destination Connection
      ID and is either 0 octets in length or between 4 and 18 octets.
      Section 7.2 describes the use of this field in more detail.

   Length: variable

      The length of the remainder of the packet (that is, the Packet
      Number and Payload fields) in octets, encoded as a variable-length
      integer (format defined in Section 16).

   Packet Number: variable

      The packet number field is 1, 2, or 4 octets long.
      The packet number has confidentiality protection separate from
      packet protection, as described in Section 5.3 of [QUIC-TLS].  The
      length of the packet number field is encoded in the plaintext
      packet number. (format defined in Section 17.1).
                        b
   Payload:  The payload of the packet.

   The following packet types are defined:

                 +------+-----------------+--------------+
                 | Type | Name            | Section      |
                 +------+-----------------+--------------+
                 | 0x7F | Initial         | Section 17.5 |
                 |      |                 |              |
                 | 0x7E | Retry           | Section 17.7 |
                 |      |                 |              |
                 | 0x7D | Handshake       | Section 17.6 |
                 |      |                 |              |
                 | 0x7C | 0-RTT Protected | Section 12.1 |
                 +------+-----------------+--------------+

                     Table 6: Long Header Packet Types

   The header form, type, connection ID lengths octet, destination and
   source connection IDs, and version fields of a long header packet are
   version-independent.  The packet number and values for packet types
   defined in Table 6 are version-specific.  See [QUIC-INVARIANTS] for
   details on how packets from different versions of QUIC are
   interpreted.

   The interpretation of the fields and the payload are specific to a
   version and packet type.  Type-specific semantics for this version
   are described in the following sections.

   The end of the packet is determined by the Length field.  The Length
   field covers both the Packet Number and Payload fields, both of which
   are confidentiality protected and initially of unknown length.  The
   size of the Payload field is learned once the packet number
   protection is removed.  The Length field enables packet coalescing
   (Section 12.2).