packet_type := bit[7];
version := bit[32];
cid_len := bit[4];
frame_type := bit[8];

var_enc := {
	length : bit[2];
	value  : bit[];
};

packet_num := {
	length : bit[1];
	pnum   : bit[];
};

long_hdr := {
	header_type   : bit;
	type		  : packet_type;
	version		  : version;
	dcid_len	  : cid_len;
	scid_len	  : cid_len;
	dcid		  : bit[];
	scid		  : bit[];
	payload_len   : var_enc;
	packet_number : packet_num;
	payload		  : bit[];	
} where { 
	header_type = 1;
};

short_hdr := {
	header_type	      : bit;
	key_phase         : bit;
	third_bit         : bit;
	forth_bit         : bit;
	google_demux      : bit;
	reserved          : bit[3];
	dcid              : bit[];
	packet_number     : packet_num;
	protected_payload : bit[];
} where { 
	header_type = 0;
	third_bit = 1;
	forth_bit = 1;
	google_demux = 0;
};

version_negotiation := {
	header_type        : bit;
	unused			   : bit[7];
	ver				   : version;
	dcid_len		   : cid_len;
	scid_len		   : cid_len;
	dcid			   : bit[];
	scid			   : bit[];
	supported_versions : version[];
} where { 
	header_type = 1;
};

padding_frame := {
	type 	: frame_type;
};